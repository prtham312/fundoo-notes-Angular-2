<app-toolbar
  [title]="sectionTitle"
  (menuClicked)="isSidenavOpen = !isSidenavOpen"
  [viewMode]="viewMode"
  (toggleView)="toggleViewMode()"
  (searchChanged)="onSearch($event)"
></app-toolbar>

<mat-sidenav-container class="sidenav-container">
  <mat-sidenav
    mode="side"
    [opened]="true"
    [class.mat-drawer-collapsed]="!sidenavOpened && !isHovered"
    (mouseenter)="onMouseEnterSidenav()"
    (mouseleave)="onMouseLeaveSidenav()"
    class="custom-sidenav"
  >
    <app-sidenav></app-sidenav>
  </mat-sidenav>

  <mat-sidenav-content>
    <div class="dashboard-content">

      <!-- ✅ Notes Section -->
      <ng-container *ngIf="currentSection === 'notes'">
        <app-note-input (noteAdded)="onNoteCreated($event)"></app-note-input>

        <div *ngIf="pinnedNotes.length === 0 && otherNotes.length === 0" class="empty-notes-placeholder">
          <mat-icon class="empty-icon">lightbulb_outline</mat-icon>
          <p class="empty-message">Notes you add appear here</p>
        </div>

        <!-- ✅ PINNED -->
        <div *ngIf="(searching ? filteredPinned : pinnedNotes).length > 0" class="note-section">
          <div class="note-section-heading"></div>
          <div class="notes-container" [ngClass]="viewMode">
            <app-note-card
              *ngFor="let note of (searching ? filteredPinned : pinnedNotes)"
              [id]="note.id"
              [title]="note.title"
              [description]="note.description"
              [color]="note.color || '#fff'"
              [isPined]="note.isPined"
              [searchTerm]="searchTerm"
              [ngClass]="viewMode"
              (pinToggled)="fetchNotesFromAPI()"
              (archived)="onNoteArchived()"
              (trashed)="onNoteTrashed(note.id)"
              (editNoteClicked)="openEditDialog(note)"  
            ></app-note-card>
          </div>
        </div>

        <!-- ✅ OTHERS -->
        <div *ngIf="(searching ? filteredNotes : otherNotes).length > 0" class="note-section">
          <div *ngIf="(searching ? filteredPinned : pinnedNotes).length > 0" class="note-section-heading">
            OTHERS
          </div>
          <div class="notes-container" [ngClass]="viewMode">
            <app-note-card
              *ngFor="let note of (searching ? filteredNotes : otherNotes)"
              [id]="note.id"
              [title]="note.title"
              [description]="note.description"
              [color]="note.color || '#fff'"
              [isPined]="note.isPined"
              [searchTerm]="searchTerm"
              [ngClass]="viewMode"
              (pinToggled)="fetchNotesFromAPI()"
              (archived)="onNoteArchived()"
              (trashed)="onNoteTrashed(note.id)"
              (editNoteClicked)="openEditDialog(note)"   
            ></app-note-card>
          </div>
        </div>
      </ng-container>

      <!-- ✅ Archive -->
      <app-archive *ngIf="currentSection === 'archive'" [viewMode]="viewMode"></app-archive>

      <!-- ✅ Trash -->
      <app-trash *ngIf="currentSection === 'trash'" [viewMode]="viewMode"></app-trash>

    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
